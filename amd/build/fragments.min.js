define ("report_vmoodle/fragments",["jquery","core/config","core/log"],function($,cfg,log){var reportfragment={init:function init(){$(".delegated-content").each(function(){$(this).promise().done(reportfragment.fragmentloader(this))});log.debug("ADM Vmoodle Report Report fragment initialized")},fragmentloader:function fragmentloader(elm){var that=$(elm),url=cfg.wwwroot+"/report/vmoodle/ajax/service.php";url+="?what=getfragment";url+="&fragment="+that.attr("delegated-fragment");url+="&wwwroot="+that.attr("delegated-context");url+="&filter="+that.attr("delegated-filter");$.get(url,function(data){var newval;log.debug("Feeding tr[delegated-context=\""+data.source+"\"]");$("tr[delegated-context=\""+data.source+"\"]").html(data.html);for(var field in data.data){newval=parseInt($("#sumator-"+field).html());log.debug("ADM Vmoodle updating field "+field);log.debug("ADM origin value "+newval);$("#sumator-"+field).html(newval+parseInt(data.data[field]))}$(".sumator-ratio").each(function(){var that=$(this),formula=that.attr("data-formula"),regexp=/(sumator-[a-z]+)/g,vars=formula.match(regexp),_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _iterator=vars[Symbol.iterator](),_step,variable;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){variable=_step.value;varvalue=parseInt($("#"+variable).html());log.debug("replacing "+variable+" with "+varvalue);formula=formula.replace(variable,varvalue)}}catch(a){_didIteratorError=!0;_iteratorError=a}finally{try{if(!_iteratorNormalCompletion&&null!=_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}log.debug("formula "+formula);var ratioresult=eval(formula);that.html("("+ratioresult+"% )")})},"json")}};return reportfragment});
//# sourceMappingURL=fragments.min.js.map
